(this["webpackJsonptable-cars"]=this["webpackJsonptable-cars"]||[]).push([[0],{20:function(t,e,a){},21:function(t,e,a){},23:function(t,e,a){},25:function(t,e,a){},26:function(t,e,a){},27:function(t,e,a){},34:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),c=a(8),i=a.n(c),o=(a(20),a(21),a(5)),l=a.n(o),s=a(9),u=a(15),_=(a(23),a(1)),b=function(t){var e=t.text,a=t.onClick;return Object(_.jsx)("button",{className:"Button",onClick:a,children:e})},d=(a(25),a.p+"static/media/search.e98153e6.svg"),f=function(t){var e=t.value,a=t.onChange,n=t.onKeypress,r=t.placeholder;return Object(_.jsxs)("div",{className:"SearchInput",children:[Object(_.jsx)("img",{className:"SearchInput__image",src:d,alt:"search"}),Object(_.jsx)("input",{className:"SearchInput__input",value:e,onChange:function(t){a(t.target.value)},placeholder:r,onKeyPress:n})]})},j=(a(26),function(t){var e=t.text;return Object(_.jsx)("p",{className:"Message",children:e})}),m=a(4),C=a.n(m),h={positionColumn:{LEFT:"POSITION_COLUMN_LEFT",CENTER:"POSITION_COLUMN_CENTER"},sortColumn:{NONE:"NONE",ASCEDING:"ASCEDING",DESCEDING:"DESCEDING"}},O=function(t){var e=t.id,a=t.text,n=t.isCenter;return Object(_.jsx)("div",{className:"Table__cell ".concat(n?"Table__cell_center":""),"data-id":e,children:a||"\u2014"})},p=a.p+"static/media/filter.eddb4308.svg",E=function(t){var e,a,n=t.metaData,r=t.arrColumnData,c=t.arrRowId;return Object(_.jsxs)("div",{"data-title-column":n.titleColumn,className:"Table__column",children:[Object(_.jsxs)("h3",{className:"Table__cell Table__header-cell ".concat((a=n.position,a===h.positionColumn.CENTER?"Table__cell_center":"")),children:[n.titleColumn,n.typeFilter!==h.sortColumn.NONE&&Object(_.jsx)("img",{className:"Table__header-filter-icon ".concat((e=n.typeFilter,e===h.sortColumn.DESCEDING?"Table__header-filter-icon_desceding":"")),src:p,alt:"filter"})]}),Object(_.jsx)("div",{children:r.map((function(t,e){return Object(_.jsx)(O,{text:t,id:c[e],isCenter:n.position===h.positionColumn.CENTER},c[e])}))})]})},D=(a(27),function(t){var e=t.arrMetaData,a=t.matrixColumnData,r=t.arrRowId,c=t.onClickHeaderColumn,i=void 0===c?function(t){}:c,o=t.onClickCell,l=void 0===o?function(t,e){}:o,s=Object(n.useCallback)((function(t){var e=t.target.closest(".Table__header-cell");if(e){var a=e.closest(".Table__column");return i(a.dataset.titleColumn),!1}var n=t.target.closest(".Table__cell");if(n){var r=n.closest(".Table__column");l(n.dataset.id,r.dataset.titleColumn)}}),[i,l]);return Object(_.jsx)("div",{className:"Table",onClick:s,children:e.map((function(t,e){return Object(_.jsx)(E,{metaData:t,arrColumnData:a.length>0?a[e]:[],arrRowId:a.length>0?r:[]},t.titleColumn)}))})}),v=function(){return Object(s.a)(l.a.mark((function t(){var e;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://city-mobil.ru/api/cars");case 2:return e=t.sent,t.next=5,e.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))()},N=a(7),x={transformApiDataToTableData:function(t){return{arrMetaData:this.getArrMetaDataByApiData(t),matrixColumnData:this.getMatrixDataByApiData(t)}},getArrMetaDataByApiData:function(t){var e=t.tariffs_list.map((function(t,e){return{titleColumn:t,position:h.positionColumn.CENTER,typeFilter:h.sortColumn.NONE}}));return[{titleColumn:"\u041c\u0430\u0440\u043a\u0430 \u0438 \u043c\u043e\u0434\u0435\u043b\u044c",position:h.positionColumn.LEFT,typeFilter:h.sortColumn.NONE}].concat(Object(N.a)(e))},getMatrixDataByApiData:function(t){var e=[],a=t.tariffs_list.map((function(){return[]}));return t.cars.forEach((function(n){e.push("".concat(n.mark," ").concat(n.model)),t.tariffs_list.forEach((function(t,e){a[e].push(void 0)})),Object.keys(n.tariffs).forEach((function(r){var c=t.tariffs_list.indexOf(r);a[c][e.length-1]=n.tariffs[r].year}))})),[e].concat(Object(N.a)(a))},sortMatrixData:function(t,e){var a=this,n=this.transpose(t);return Object(N.a)(e).reverse().forEach((function(t,r){var c=t.typeFilter,i=e.length-r-1;c!==h.sortColumn.NONE&&n.sort((function(t,e){var n=a.compareCell(t[i],e[i]);return c===h.sortColumn.DESCEDING?-n:n}))})),this.transpose(n)},transpose:function(t){for(var e=Object(N.a)(t[0].map((function(){return[]}))),a=0;a<t.length;a++)for(var n=0;n<t[a].length;n++)e[n][a]=t[a][n];return e},compareCell:function(t,e){return t===e?0:t?e?t>e?1:-1:1:-1},filterMatrixData:function(t,e){var a=e.toLowerCase(),n=this.transpose(t).filter((function(t){return t.some((function(t){var e=String(t).toLowerCase();return e&&e.includes(a)}))}));return n.length>0?this.transpose(n):n}},T=a(2),g=a(11),A=a(3),I={CHANGE_ALL_DATA_WITHOUT_FILTERS:"CHANGE_ALL_DATA_WITHOUT_FILTERS",TOGGLE_FILTER:"TOGGLE_FILTER",CHANGE_SEARCH_FIELD:"CHANGE_SEARCH_FIELD",CHANGE_ACTIVE_ROW_ID:"CHANGE_ACTIVE_ROW_ID"},M={arrMetaData:[],matrixColumnData:[],searchField:"",activeRowId:void 0},F=Object(g.a)({reducerTable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case I.CHANGE_ACTIVE_ROW_ID:return Object(A.a)(Object(A.a)({},t),{},{activeRowId:e.activeRowId});case I.CHANGE_SEARCH_FIELD:return Object(A.a)(Object(A.a)({},t),{},{searchField:e.searchField});case I.TOGGLE_FILTER:return Object(A.a)(Object(A.a)({},t),{},{arrMetaData:t.arrMetaData.map((function(t){return t.titleColumn!==e.titleColumn?t:(a=t.typeFilter===h.sortColumn.NONE?h.sortColumn.ASCEDING:t.typeFilter===h.sortColumn.ASCEDING?h.sortColumn.DESCEDING:h.sortColumn.NONE,Object(A.a)(Object(A.a)({},t),{},{typeFilter:a}));var a}))});case I.CHANGE_ALL_DATA_WITHOUT_FILTERS:return Object(A.a)(Object(A.a)({},t),{},{arrMetaData:e.arrMetaData,matrixColumnData:e.matrixColumnData});default:return t}}}),R=Object(A.a)({},{getTableArrMetaData:function(t){return t.reducerTable.arrMetaData},getTableMatrixColumnData:function(t){return t.reducerTable.matrixColumnData},getSearchField:function(t){return t.reducerTable.searchField},getActiveRowId:function(t){return t.reducerTable.activeRowId}}),L={changeAllDataWithoutFilters:function(t,e){return{type:I.CHANGE_ALL_DATA_WITHOUT_FILTERS,arrMetaData:t,matrixColumnData:e}},toggleFilter:function(t){return{type:I.TOGGLE_FILTER,titleColumn:t}},changeSearchField:function(t){return{type:I.CHANGE_SEARCH_FIELD,searchField:t}},changeActiveRowId:function(t){return{type:I.CHANGE_ACTIVE_ROW_ID,activeRowId:t}}},S=Object(g.b)(F),G=function(){var t=Object(T.c)(R.getTableArrMetaData),e=Object(T.c)(R.getSearchField),a=function(){var t=Object(T.c)(R.getActiveRowId),e=Object(T.c)(R.getTableMatrixColumnData);if(t){for(var a=e[0].findIndex((function(e){return e===t})),n=e[0][a],r=e[1][a],c=2;c<e.length;c++)r=Math.min(r,e[1][a]);return"".concat(n," ").concat(r)}}(),r=function(){var t=Object(T.c)(R.getTableArrMetaData),e=Object(T.c)(R.getSearchField),a=Object(T.c)(R.getTableMatrixColumnData);return a=Object(n.useMemo)((function(){return 0===a.length?a:x.filterMatrixData(a,e)}),[e,a]),a=Object(n.useMemo)((function(){return 0===a.length?a:x.sortMatrixData(a,t)}),[t,a])}(),c=Object(n.useState)(e),i=Object(u.a)(c,2),o=i[0],d=i[1],m=Object(T.b)(),h=Object(n.useCallback)((function(t,e){m(L.changeAllDataWithoutFilters(t,e))}),[m]),O=Object(n.useCallback)((function(t){m(L.toggleFilter(t))}),[m]),p=Object(n.useCallback)((function(t){m(L.changeSearchField(t))}),[m]),E=Object(n.useCallback)((function(t){m(L.changeActiveRowId(t))}),[m]);Object(n.useEffect)((function(){Object(s.a)(l.a.mark((function t(){var e,a,n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v();case 2:e=t.sent,a=x.transformApiDataToTableData(e),n=a.arrMetaData,r=a.matrixColumnData,h(n,r);case 5:case"end":return t.stop()}}),t)})))()}),[]);var N=Object(n.useCallback)((function(t){O(t)}),[O]),g=Object(n.useCallback)((function(t){E(t)}),[E]),A=function(){p(o)};return Object(_.jsxs)("div",{className:C.a.Main,children:[Object(_.jsx)("div",{className:C.a.Main__container,children:Object(_.jsxs)("div",{className:C.a.searchField,children:[Object(_.jsx)("div",{className:C.a.searchField__input,children:Object(_.jsx)(f,{value:o,onChange:d,onKeypress:function(t){"Enter"===t.key&&A()},placeholder:"\u041d\u0430\u0439\u0442\u0438"})}),Object(_.jsx)(b,{text:"\u041d\u0430\u0439\u0442\u0438",onClick:A})]})}),Object(_.jsx)("div",{className:"".concat(C.a.Main__container," ").concat(C.a.Main__table),children:Object(_.jsx)(D,{arrMetaData:t,matrixColumnData:r,arrRowId:r[0],onClickCell:g,onClickHeaderColumn:N})}),e&&0===r.length&&t.length>0&&Object(_.jsx)("div",{className:C.a.Main__container,children:Object(_.jsx)(j,{text:"".concat(e," \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e")})}),a&&Object(_.jsx)("div",{className:C.a.Main__container,children:Object(_.jsx)(j,{text:"\u0412\u044b\u0431\u0440\u0430\u043d \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c ".concat(a," \u0433\u043e\u0434\u0430 \u0432\u044b\u043f\u0443\u0441\u043a\u0430")})})]})};var y=function(){return Object(_.jsxs)("div",{className:"App",children:[Object(_.jsx)("header",{className:"App__header",children:"header"}),Object(_.jsx)("nav",{className:"App__navbar",children:"sidebar"}),Object(_.jsx)("main",{className:"App__main",children:Object(_.jsx)(G,{})}),Object(_.jsx)("footer",{className:"App__footer",children:"footer"})]})},w=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,35)).then((function(e){var a=e.getCLS,n=e.getFID,r=e.getFCP,c=e.getLCP,i=e.getTTFB;a(t),n(t),r(t),c(t),i(t)}))};i.a.render(Object(_.jsx)(r.a.StrictMode,{children:Object(_.jsx)(T.a,{store:S,children:Object(_.jsx)(y,{})})}),document.getElementById("root")),w()},4:function(t,e,a){t.exports={Main:"Main_Main__1nXpt",Main__container:"Main_Main__container__2IHsO",Main__table:"Main_Main__table__NbeQB",searchField:"Main_searchField__3qwpx",searchField__input:"Main_searchField__input__sBOdo"}}},[[34,1,2]]]);
//# sourceMappingURL=main.d52c1c88.chunk.js.map